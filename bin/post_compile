#!/bin/bash

# Встановлюємо змінну середовища DJANGO_SETTINGS_MODULE для правильного шляху до налаштувань
export DJANGO_SETTINGS_MODULE=src.settings

# Додаємо кореневу директорію проекту в PYTHONPATH
BUILD_DIR=$(dirname "$(find / -name manage.py 2>/dev/null)")
export PYTHONPATH=$BUILD_DIR

echo "Starting post_compile script..."

# Перевірка вмісту кореневої директорії
ls -la /

# Пошук файлу manage.py
echo "Found manage.py at: $BUILD_DIR/manage.py"

# Виведення значення змінної PYTHONPATH
echo "PYTHONPATH is set to: $PYTHONPATH"

# Виконуємо команду для компіляції файлів перекладу, якщо manage.py було знайдено
if [ -n "$BUILD_DIR" ]; then
    python "$BUILD_DIR/manage.py" compilemessages
else
    echo "manage.py not found. Skipping compilemessages."
fi

echo "Finished compilemessages step."
